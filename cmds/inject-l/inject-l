#!/usr/bin/env -S awk -f ${_} --

######################################################################
# Init
function printerr(msg) {
    print msg > "/dev/stderr"
}

BEGIN {
  # Remove the script path
  delete ARGV[1]
  # Parse Options
  if ( \
    ARGV[i] == "-h"        ||
    ARGV[i] == "--help"    ||
    ARGV[i] == "-v"        ||
    ARGV[i] == "--version" ||
    ARGC == 1              \
  ){
    printerr("inject-l - inject file to template by line")
    printerr("")
    printerr("Usage: inject-l <keyword> <template-file> <data-file>")
    printerr("Description: Injects the string into the template file with the data file")
    exit 1
  }
  keyword = ARGV[2] ; delete ARGV[2]
  datafile = ARGV[4]; delete ARGV[4]
}

######################################################################
# Main Routine
{
  if (index($0, keyword)) {
    system("cat " datafile)
  } else {
    print
  }
}
